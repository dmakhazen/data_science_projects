<p><img style="float:right; margin:20px; padding:20px; max-height:200px" src="https://as2.ftcdn.net/v2/jpg/03/08/02/45/1000_F_308024548_kMQJ3FWfmUX2djOl9tAYCYeToAs97o6h.jpg"></p>
<p style="text-align:justify;">

# Movies revenue prediction

Результат:
- [Jupyter_notebook](https://github.com/dmakhazen/portfolio/tree/main/movies_revenue_prediction/movies_revenue_prediction.ipynb)
- [Colab](https://colab.research.google.com/drive/1IK7JxBWnqFWykG2_5swYKwAf6pioSXK2?usp=sharing)
- [Презентация результатов](https://github.com/dmakhazen/portfolio/blob/main/movies_revenue_prediction/ML%20movies.png)

## Описание проекта

**Описание проблемы**
   
К вам обращается компания, управляющая кинотеатрами. Компания хочет предсказать, насколько успешным будет фильм, еще до его выхода. Компания хочет использовать эти прогнозы как часть планирования расписания фильмов. Компания предоставляет вам набор данных и просит вас создать модель машинного обучения, чтобы помочь им.

**Цель**

Создать ML модель, которая будет предсказывать полученную прибыль в процессе показа фильма. Метрика - RMSE. 

## Ключевые особенности
- Оригинальное преобразование признаков
- Подбор не только гиперпараметров, но и параметров для обработки данных
- Множество моделей, их сравнение

## Инструменты, навыки

Инструменты:
- Pandas
- Matplotlib
- Seaborn
- Numpy
- Sklearn
- Catboost

Навыки:
- Подготовка данных
- Исследовательский анализ
- Создание моделей ML

## Результаты
<font size=4>**Модель**</font>

- Модель построена и работает
- Основа модели - CatboostRegressor
- RMSE модели ~87 млн $
- Скорость обучения и предсказания модели довольно высока, модель можно быстро обучить заново на новых данных

<font size=4>**Данные и признаки**</font>

- Основная проблема этой задачи - обработка признаков и поиск актуального периода. Если бинарно классифицировать всех доступных актеров/режиссеров/компаний и др., количество признаков становится огромным и:
   1. Модель становится медленной
   2. Метрика RMSE падает

- Поэтому была создана функция для кастомной и настраиваемой подготовки признаков:
  1. Кратко суть функции - выделить n-топ (топ по выручке фильмов, n - параметр функции) актеров, режиссеров, продакшн-компаний и сделать из них признаки.
  2. Данной функцией можно подобрать количество топ значимых признаков
  3. Также в параметрах функции можно указать год начала данных (необходимо для актуализации периода)
  4. При больших вычислительных ресурсах можно еще попробовать поискать лучший вариант классификации

<font size=4>**Дальнейшее развитие модели для выхода в продакшн**</font>

- Часть признаков (например vote_count, popularity, оценки), доступных для построения модели на текущем датасете будут отсутствовать после получения новых данных (в ситуации когда фильм еще не вышел). Однако, на сайте IMDB до выхода фильма доступны аналогичные признаки, например vote_count можно заменить на wishlist_count, есть оценки критиков до выхода фильма, также присутствует аналог popularity.
- Можно собрать больше признаков парсером - например звуковые компании, количество новостей, встречаемость в подборках и другие. К тому же, можно собрать больше информации с других ресурсов, кроме IMDB.
- Необоходимо унифицировать функцию для обработки топ признаков, так как после новых фильмов будут появляться новые успешные режиссеры, актеры и др.
- Собрать настраиваемый пайплайн
